<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Afirmatii Essence Advanced</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div class="container" id="login-screen">
        <header>
            <div class="logo-container">
                <img src="https://essence-process.com/ro/wp-content/uploads/2022/10/logo-essence-int.png" alt="Essence Advanced" class="main-logo" onerror="this.style.display='none'">
            </div>
            <h1 style="margin-top: 10px;">Afirmatii Essence Advanced</h1>
            <p class="subtitle">Conectează-te cu comunitatea ta</p>
        </header>
        
        <!-- Login Form -->
        <div class="register-form" id="login-form">
            <h3>Conectează-te</h3>
            <div class="form-group">
                <label>Username:</label>
                <input type="text" id="login-username" class="form-input" placeholder="Username">
            </div>
            <div class="form-group">
                <label>Cod PIN (4 cifre):</label>
                <input type="password" id="login-pin" class="form-input" placeholder="1234" maxlength="4" autocomplete="off" inputmode="numeric">
            </div>
            <button class="btn btn-primary" id="login-submit-btn" style="width: 100%;">Conectează-te</button>
            <div id="login-status-message" class="status-message" style="margin-top: 10px;"></div>
            <div style="margin-top: 15px; text-align: center;">
                <button class="btn btn-secondary" onclick="document.getElementById('register-form').style.display='block'; document.getElementById('login-form').style.display='none';" style="width: 100%;">
                    Înregistrare Nouă
                </button>
            </div>
            <div style="margin-top: 10px; text-align: center;">
                <button class="forgot-btn" onclick="showForgotPinModal()" style="background: transparent; border: none; color: #667eea; text-decoration: underline; cursor: pointer;">
                    Am uitat PIN-ul
                </button>
            </div>
            
            <p class="login-hint" id="login-hint" style="display: none;">Sau alege un utilizator pentru conectare rapidă:</p>
            <div class="users-list" id="users-list" style="display: none;"></div>
            <p class="login-note" id="login-note" style="display: none;">
                <small>Click pe utilizatorul tău pentru login rapid (fără PIN)<br>
                Click pe alți utilizatori pentru login cu PIN</small>
            </p>
        </div>
        
        <div class="register-form" id="register-form" style="display: none;">
            <h3>📝 Înregistrare Nouă</h3>
            
                <div class="form-group">
                    <label>Username (unic):</label>
                    <input type="text" id="reg-username" class="form-input" placeholder="ex: ion123" maxlength="20">
                    <div id="username-status" class="status-message"></div>
                    <div id="lastname-status" class="status-message"></div>
                </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Prenume:</label>
                    <input type="text" id="reg-first-name" class="form-input" placeholder="Prenume">
                </div>
                <div class="form-group">
                    <label>Nume:</label>
                    <input type="text" id="reg-last-name" class="form-input" placeholder="Nume">
                    <div id="lastname-status" class="status-message"></div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group" style="flex: 1;">
                    <label>Email (obligatoriu):</label>
                    <input type="email" id="reg-email" class="form-input" placeholder="ex: nume@email.com">
                    <div id="email-status" class="status-message"></div>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Număr de telefon:</label>
                    <input type="tel" id="reg-phone" class="form-input" placeholder="ex: +40712345678">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group" style="flex: 0 0 150px;">
                    <label>Cod PIN (4 cifre):</label>
                    <input type="password" id="reg-pin" class="form-input" placeholder="1234" maxlength="4" autocomplete="off" inputmode="numeric">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Data nașterii:</label>
                    <input type="date" id="reg-birth-date" class="form-input" min="1900-01-01" max="2010-12-31">
                </div>
            </div>
            
            <div class="form-group">
                <label>Afirmația ta (opțional):</label>
                <textarea id="reg-affirmation" class="form-textarea" placeholder="Scrie afirmația ta aici...">Sunt capabil să realizez tot ce îmi propun.</textarea>
            </div>
            
            <div class="form-group">
                <label>Alege un avatar:</label>
                <div class="avatar-grid">
                    <div class="avatar-option active" data-avatar="👤">👤</div>
                    <div class="avatar-option" data-avatar="👨">👨</div>
                    <div class="avatar-option" data-avatar="👩">👩</div>
                    <div class="avatar-option" data-avatar="👦">👦</div>
                    <div class="avatar-option" data-avatar="👧">👧</div>
                    <div class="avatar-option" data-avatar="🧑‍🦰">🧑‍🦰</div>
                    <div class="avatar-option" data-avatar="👱‍♂️">👱‍♂️</div>
                    <div class="avatar-option" data-avatar="👱‍♀️">👱‍♀️</div>
                    <div class="avatar-option" data-avatar="🧑‍🦱">🧑‍🦱</div>
                    <div class="avatar-option" data-avatar="🧑‍🦳">🧑‍🦳</div>
                    <div class="avatar-option" data-avatar="👨‍🦰">👨‍🦰</div>
                    <div class="avatar-option" data-avatar="👩‍🦰">👩‍🦰</div>
                    <div class="avatar-option" data-avatar="👨‍🦱">👨‍🦱</div>
                    <div class="avatar-option" data-avatar="👩‍🦱">👩‍🦱</div>
                    <div class="avatar-option" data-avatar="🧑‍🦲">🧑‍🦲</div>
                </div>
                <input type="file" id="avatar-upload" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('avatar-upload').click()" style="margin-top: 10px;">Adaugă poza ta</button>
            </div>
            
            <button id="register-btn" class="btn btn-primary">✅ Înregistrează-te</button>
            <button id="cancel-register-btn" class="btn btn-secondary">❌ Anulează</button>
        </div>
        
        
        <div class="forgot-pin-modal" id="forgot-pin-modal" style="display: none;">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>🔑 Resetare PIN</h2>
                    <button id="close-forgot-btn" class="close-btn">✕</button>
                </div>
                
                <div class="settings-body">
                    <div class="setting-section">
                        <h3>Introdu datele tale</h3>
                        <div class="form-group">
                            <label>Username:</label>
                            <input type="text" id="forgot-username" class="form-input" placeholder="Username">
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="forgot-email" class="form-input" placeholder="Email asociat contului">
                        </div>
                        <button id="reset-pin-btn" class="btn btn-primary">📧 Trimite cod de resetare</button>
                        <div id="reset-status" class="status-message"></div>
                        
                        <div id="reset-code-section" style="display: none;">
                            <div class="form-group">
                                <label>Cod de resetare (trimis pe email):</label>
                                <input type="text" id="reset-code" class="form-input" placeholder="Ex: A7B9" maxlength="6">
                            </div>
                            <div class="form-group">
                                <label>PIN nou:</label>
                                <input type="password" id="new-reset-pin" class="form-input" placeholder="4 cifre" maxlength="4">
                            </div>
                            <button id="confirm-reset-pin-btn" class="btn btn-primary">✅ Confirmă resetare</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Group Selection Screen (after registration) -->
        <div class="container" id="group-selection-screen" style="display: none;">
            <header>
                <div class="logo-container">
                    <img src="https://essence-process.com/ro/wp-content/uploads/2022/10/logo-essence-int.png" alt="Essence Advanced" class="main-logo" onerror="this.style.display='none'">
                </div>
                <h1>🎯 Selectează un Grup</h1>
                <p class="subtitle">Alătură-te unui grup pentru a continua</p>
            </header>
            
            <div class="groups-list">
                <h3>Grupuri Disponibile</h3>
                <div id="registration-groups-list"></div>
                
                <div class="form-group">
                    <label>Introdu codul grupului:</label>
                    <input type="text" id="reg-group-code" class="form-input" placeholder="Cod grup (6 cifre)">
                    <button id="join-reg-group-btn" class="btn btn-primary">✅ Alătură-te</button>
                </div>
                <div id="reg-join-status" class="status-message"></div>
            </div>
        </div>
    </div>

    <!-- Main Screen -->
    <div class="container" id="main-screen" style="display: none;">
        <header class="main-header">
            <img src="https://essence-process.com/ro/wp-content/uploads/2022/10/logo-essence-int.png" alt="Essence Advanced" class="header-logo" onerror="this.style.display='none'">
        </header>
        
        <p class="current-user-info" style="text-align: center; margin: 10px 0 20px 0; color: #5f6368;">
            Utilizator: <strong id="current-user">-</strong>
        </p>

        <div class="button-group header-buttons" style="margin-bottom: 20px;">
            <button class="btn-small btn-blue" id="admin-btn" style="display: none;">Admin</button>
            <button class="btn-small btn-blue" id="settings-btn">Setări</button>
            <button id="toggle-feed-btn" class="btn-small">Feed</button>
            <button id="toggle-chat-btn" class="btn-small">Chat</button>
            <button id="toggle-groups-btn" class="btn-small">Grupuri</button>
            <button class="btn-small btn-red" id="logout-btn">Ieșire</button>
        </div>

        <!-- Settings Modal -->
        <div class="settings-modal" id="settings-modal" style="display: none;">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>⚙️ Setări</h2>
                    <button id="close-settings-btn" class="close-btn">✕</button>
                </div>
                
                <div class="settings-body">
                    <div class="setting-section">
                        <h3>🔐 Schimbă PIN</h3>
                        <div class="form-group">
                            <label>PIN actual:</label>
                            <input type="password" id="current-pin" class="form-input" placeholder="PIN actual" maxlength="4">
                        </div>
                        <div class="form-group">
                            <label>PIN nou:</label>
                            <input type="password" id="new-pin" class="form-input" placeholder="PIN nou (4 cifre)" maxlength="4">
                        </div>
                        <div class="form-group">
                            <label>Confirmă PIN nou:</label>
                            <input type="password" id="confirm-pin" class="form-input" placeholder="Confirmă PIN nou" maxlength="4">
                        </div>
                        <button id="change-pin-btn" class="btn btn-primary">💾 Salvează PIN</button>
                        <div id="pin-status" class="status-message"></div>
                    </div>
                    
                    <div class="setting-section">
                        <h3>👤 Schimbă Avatar</h3>
                        <div class="avatar-grid" id="settings-avatar-grid">
                            <!-- Avatarele vor fi generate aici -->
                        </div>
                        <input type="file" id="settings-avatar-upload" accept="image/*" style="display: none;" onchange="handleSettingsAvatarUpload(event)">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('settings-avatar-upload').click()" style="margin-top: 10px;">Adaugă poza ta</button>
                        <button id="change-avatar-btn" class="btn btn-primary" style="margin-top: 10px;">💾 Salvează Avatar</button>
                        <div id="avatar-status" class="status-message"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="community-stats">
            <div class="stat-item-small">
                <span class="stat-number-small" id="community-active">0</span>
                <span class="stat-label-small">Utilizatori activi</span>
            </div>
            <div class="stat-item-small">
                <span class="stat-number-small" id="community-total">0</span>
                <span class="stat-label-small">Total repetări</span>
            </div>
        </div>

        
        <div class="groups-section" id="groups-section" style="display: none;">
            <h3>🎯 Grupuri Disponibile</h3>
            <div id="available-groups-list" style="margin-bottom: 20px;"></div>
            
            <div id="join-group-section">
                <h3>🔐 Alătură-te unui Grup cu Cod Secret</h3>
                <div class="form-group">
                    <input type="text" id="group-code-input" class="form-input" placeholder="Introdu codul secret (6 cifre)">
                    <button id="join-group-btn" class="btn btn-primary">✅ Alătură-te</button>
                </div>
                <div id="join-status" class="status-message"></div>
            </div>
            
            <h3 id="my-groups-title" style="display: none;">🎯 Grupurile Mele</h3>
            <div id="user-groups-list" style="margin-bottom: 20px;"></div>
        </div>
        
        <div class="group-chat-container" id="group-chat-container" style="display: none;">
            <div class="group-chat-header">
                <div>
                    <h3 id="group-chat-title">💬 Chat Grup</h3>
                    <p id="group-members-count">0 membri</p>
                </div>
                <button id="close-group-chat-btn" class="close-btn-small">✕</button>
            </div>
            <div id="group-members-list" class="group-members-list"></div>
            <div id="group-chat-messages" class="chat-messages"></div>
            <div class="chat-input-container">
                <input type="text" id="group-chat-input" class="chat-input" placeholder="Scrie un mesaj...">
                <button id="send-group-chat-btn" class="btn btn-primary">Trimite</button>
            </div>
        </div>

        <div class="chat-container" id="chat-container" style="display: none;">
            <div class="chat-header">
                <h3>💬 Chat Comunitate</h3>
                <button id="close-chat-btn" class="close-btn-small">✕</button>
            </div>
            <div class="chat-messages" id="chat-messages"></div>
            <div class="chat-input-container">
                <input type="text" id="chat-input" class="chat-input" placeholder="Scrie un mesaj...">
                <button id="send-chat-btn" class="btn btn-primary">📤 Trimite</button>
            </div>
        </div>

        <div class="feed-container" id="feed-container" style="display: none;">
            <div id="feed-content"></div>
        </div>

        <div class="affirmation-card" id="affirmation-card">
            <div class="affirmation-content">
                <div class="quote-mark">"</div>
                <textarea class="affirmation-text" id="affirmation-text" placeholder="Scrie afirmația ta aici..." style="height: auto; overflow: visible;">Sunt capabil să realizez tot ce îmi propun.</textarea>
            </div>
            <div style="text-align: center;">
                <button class="btn btn-secondary" id="save-affirmation-btn">💾 Salvează Afirmația</button>
            </div>
        </div>

        <!-- Calendar on main page -->
        <div id="main-calendar-section" style="display: block;">
            <div class="calendar-section" style="margin: 20px 0;">
                <h4 style="margin-bottom: 10px;">📅 Calendar Provocare</h4>
                <div id="main-calendar" class="challenge-calendar">
                    <!-- Calendar will be generated here -->
                </div>
                <p style="font-size: 12px; color: #5f6368; margin-top: 10px;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #34a853; border-radius: 2px; margin-right: 5px;"></span> Zi completă (100 repetări)
                    <span style="display: inline-block; width: 12px; height: 12px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 2px; margin-left: 15px; margin-right: 5px;"></span> Zi în așteptare
                </p>
            </div>
        </div>

        <div class="challenge-box">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h3 style="margin: 0;">🎯 Provocare 30 Zile</h3>
                    <p class="challenge-subtitle" id="time-remaining-display" style="margin: 5px 0 0 0; color: #5f6368; font-size: 12px;"></p>
                </div>
                <button id="toggle-history-btn" class="btn btn-small" style="padding: 8px 15px; font-size: 0.9em; background: #667eea; border: none; border-radius: 8px;">📜 Istoric</button>
            </div>
            <p class="challenge-subtitle">Repeteți afirmația 100 de ori pe zi</p>
            
            <div id="recent-repetitions-history" style="display: none;">
                <div class="recent-repetitions">
                    <h4>📝 Repetări de Astăzi</h4>
                    <div class="repetitions-list" id="repetitions-list">
                        <!-- Aici vor apărea repetările -->
                    </div>
                </div>
                
                <div class="calendar-section" style="margin-top: 20px;">
                    <h4>📅 Calendar Provocare</h4>
                    <div id="challenge-calendar" class="challenge-calendar">
                        <!-- Calendar will be generated here -->
                    </div>
                    <p style="font-size: 12px; color: #5f6368; margin-top: 10px;">
                        <span style="display: inline-block; width: 12px; height: 12px; background: #34a853; border-radius: 2px; margin-right: 5px;"></span> Zi completă (100 repetări)
                        <span style="display: inline-block; width: 12px; height: 12px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 2px; margin-left: 15px; margin-right: 5px;"></span> Zi în așteptare
                    </p>
                </div>
            </div>
            
            <div class="reminder-section" style="display: none;">
                <div class="reminder-header">
                    <label class="reminder-checkbox">
                        <input type="checkbox" id="reminder-checkbox">
                        <span>Activează Reminder</span>
                    </label>
                </div>
                <div class="reminder-controls" id="reminder-controls" style="display: none;">
                    <div class="reminder-input-group">
                        <label>Data:</label>
                        <input type="date" id="reminder-date" class="reminder-input">
                    </div>
                    <div class="reminder-input-group">
                        <label>Ora:</label>
                        <input type="time" id="reminder-time" class="reminder-input">
                    </div>
                    <div class="reminder-status" id="reminder-status"></div>
                </div>
            </div>
            
            <div class="progress-section">
                <div class="progress-item">
                    <div class="progress-label">
                        <span>Progres Zile: <strong id="day-progress">0/30</strong></span>
                        <span id="days-remaining" class="days-remaining">30 zile rămase</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="days-progress-bar"></div>
                    </div>
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                            <span>Repetări Astăzi: <strong id="repetitions-today">0/100</strong></span>
                            <span id="reps-per-hour-needed" style="color: #5f6368; font-size: 0.9em;"></span>
                        </div>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="repetitions-progress-bar"></div>
                    </div>
                </div>
            </div>

            <div class="repeat-controls">
                <button class="btn btn-repeat" id="repeat-btn">
                    Am repetat (+1)
                </button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <span class="stat-number" id="total-count">0</span>
                <span class="stat-label">Total afirmații văzute</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="liked-count">0</span>
                <span class="stat-label">Apreciate</span>
            </div>
        </div>

        <button class="btn btn-danger" id="reset-btn">
            🔄 Resetare Provocare
        </button>
    </div>
    
    <!-- Admin Screen -->
    <div class="container" id="admin-screen" style="display: none;">
        <header class="main-header">
            <div class="header-left">
                <img src="https://essence-process.com/ro/wp-content/uploads/2022/10/logo-essence-int.png" alt="Essence Advanced" class="header-logo" onerror="this.style.display='none'">
                <div>
                    <h1>⚡ Panou Administrator</h1>
                    <p class="current-user">Administrator: <strong id="admin-name">-</strong></p>
                </div>
            </div>
            <button class="btn btn-secondary" id="admin-back-btn">← Înapoi</button>
        </header>
        
        <div class="admin-stats">
            <div class="admin-stat-card">
                <div class="stat-icon">👥</div>
                <div class="stat-info">
                    <div class="stat-number" id="admin-total-users">0</div>
                    <div class="stat-label">Total Utilizatori</div>
                </div>
            </div>
            <div class="admin-stat-card">
                <div class="stat-icon">🔢</div>
                <div class="stat-info">
                    <div class="stat-number" id="admin-total-reps">0</div>
                    <div class="stat-label">Total Repetări</div>
                </div>
            </div>
            <div class="admin-stat-card">
                <div class="stat-icon">💬</div>
                <div class="stat-info">
                    <div class="stat-number" id="admin-total-messages">0</div>
                    <div class="stat-label">Mesaje Chat</div>
                </div>
            </div>
            <div class="admin-stat-card">
                <div class="stat-icon">📊</div>
                <div class="stat-info">
                    <div class="stat-number" id="admin-active-today">0</div>
                    <div class="stat-label">Activi Astăzi</div>
                </div>
            </div>
        </div>
        
        <div class="admin-tabs">
            <button class="admin-tab active" data-tab="groups">👥 Grupuri</button>
            <button class="admin-tab" data-tab="users">👤 Utilizatori</button>
            <button class="admin-tab" data-tab="messages">💬 Mesaje</button>
            <button class="admin-tab" data-tab="activities">📝 Activitate</button>
            <button class="admin-tab" data-tab="analytics">📊 Analiză</button>
        </div>
        
        <div class="admin-content">
            <div class="admin-tab-content active" id="tab-groups">
                <div class="form-group">
                    <h3>Crează Grup Nou (30 zile)</h3>
                    <input type="text" id="new-group-name" class="form-input" placeholder="Nume grup">
                    <textarea id="new-group-desc" class="form-textarea" placeholder="Descriere (opțional)"></textarea>
                    
                    <input type="date" id="new-group-start-date" class="form-input" placeholder="Data început">
                    <div style="font-size: 12px; color: #5f6368; margin-top: -10px; margin-bottom: 10px;">Grupul va dura 30 zile de la data început</div>
                    
                    <button id="create-group-btn" class="btn btn-primary">Creează Grup</button>
                    <div id="group-creation-status" class="status-message"></div>
                </div>
                <h3 style="margin-top: 30px;">Grupuri existente:</h3>
                <div id="admin-groups-list"></div>
            </div>
            <div class="admin-tab-content" id="tab-users">
                <input type="text" id="admin-search-users" class="form-input" placeholder="🔍 Caută utilizatori..." style="margin-bottom: 20px;">
                <div id="admin-users-list"></div>
            </div>
            <div class="admin-tab-content" id="tab-messages">
                <div id="admin-messages-list" class="admin-messages-container"></div>
            </div>
            <div class="admin-tab-content" id="tab-activities">
                <div id="admin-activities-list"></div>
            </div>
            <div class="admin-tab-content" id="tab-analytics">
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h3>Top Utilizatori</h3>
                        <div id="top-users"></div>
                    </div>
                    <div class="analytics-card">
                        <h3>Distribuție Repetări</h3>
                        <div id="reps-distribution"></div>
                    </div>
                    <div class="analytics-card">
                        <h3>Activitate Zilnică</h3>
                        <div id="daily-activity"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
